<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>My Three.js Vite Project</title>
  <style>
    body { margin: 0; }
    canvas { display: block; }

    /* 모델 리스트 컨테이너 */
    #model-list-container {
      position: absolute;
      left: 10px;
      top: 20%;
      transform: translateY(-50%);
      width: 300px;  /* 기본 펼쳐진 상태 폭 */
      background: rgba(0,0,0,0.5);
      color: #fff;
      font: 14px sans-serif;
      padding: 10px;
      border: 1px solid #444;
      border-radius: 4px;

      transition: width 0.3s ease;
      overflow: hidden; /* 접힘 시 내부 요소가 잘려 보이도록 */
    }

    /* (★) 가로 접힘 상태 */
    #model-list-container.collapsed-horizontal {
      width: 50px; /* 접혔을 때 폭 (원하는 값으로 조절) */
      padding: 10px 5px; /* 버튼만 보이게 최소한으로 간격 줄임 */
    }

    /* 상단 헤더 영역 (제목 + 가로 접기 버튼) */
    #model-list-header {
      display: flex;
      align-items: center;
      margin-bottom: 8px; /* 아래쪽 약간 여백 */
    }

    #model-list-header h3 {
      margin: 0;
      flex: 1; /* 오른쪽 버튼을 오른쪽 끝으로 밀기 */
      font-size: 16px;
    }

    /* 접혔을 때, 제목/기타 숨기기 */
    #model-list-container.collapsed-horizontal #model-list-header h3 {
      display: none;
    }

    /* 접혔을 때, 모델 리스트 숨기기 */
    #model-list-container.collapsed-horizontal #model-list {
      display: none;
    }

    /* 가로 접기 버튼 */
    #toggle-horizontal {
      background: transparent;
      color: #fff;
      border: none;
      font-size: 16px;
      cursor: pointer;
    }

    /* 실제 모델 리스트 <ul> */
    #model-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    /* 모델 리스트 항목 하나 (li) */
    .model-list-item {
      display: flex;         /* Flex 컨테이너 */
      align-items: center;   
      gap: 8px;              /* 내부 요소 간격 */
      cursor: pointer;
      padding: 4px 0;
      font-size: 14px;
    }

    /* 파일명에만 ellipsis 적용할 div/span */
    .model-filename {
      flex: 1;               /* 남은 공간 모두 사용 */
      overflow: hidden;
      white-space: nowrap;
      text-overflow: ellipsis;
      display: block;        
      min-width: 0;          
    }

    /* 활성/비활성 색상 */
    .model-filename--active {
      font-weight: bold;
      color: #ff6;
    }
    .model-filename--inactive {
      font-weight: normal;
      color: #fff;
    }

    /* 새 메모 입력 모달 */
    #memo-modal-new {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.8);
      padding: 20px;
      border-radius: 8px;
      color: #fff;
    }
    /* 기존 메모 수정 모달 */
    #memo-modal-edit {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.8);
      padding: 20px;
      border-radius: 8px;
      color: #fff;
    }

    /* ---- (추가) Sculpt UI (하단) ---- */
    #sculpt-ui {
      position: absolute;
      left: 10px;
      bottom: 10px;
      width: 160px;          
      background: rgba(0,0,0,0.5);
      color: #fff;
      font: 14px sans-serif;
      padding: 10px;
      border: 1px solid #444;
      border-radius: 4px;
    }
    #sculpt-ui h2 {
      margin: 0 0 4px 0;
      font-size: 14px;
      text-align: left;
      color: #ccc;
    }
    #sculpt-ui hr {
      border: none;
      border-top: 1px solid #666;
      margin: 6px 0;
    }

    /* 브러시 버튼 컨테이너 */
    .brush-buttons {
      display: flex;
      gap: 4px;
      margin-bottom: 8px;
    }
    .brush-btn {
      flex: 1;
      background: #666;
      color: #fff;
      border: none;
      border-radius: 4px;
      padding: 8px;
      cursor: pointer;
      text-align: center;
    }
    .brush-btn.active {
      background: #999;
    }

    /* 슬라이더 행 */
    .slider-row {
      margin-bottom: 8px;
    }
    .slider-row label {
      display: inline-block;
      font-size: 12px;
      margin-bottom: 4px;
    }
    .slider-row input[type="range"] {
      width: 100%;
    }

    #drag-hint {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: #ccc;
  font-size: 24px;
  text-align: center;
  pointer-events: none; /* 마우스 이벤트 무시 */
}

  </style>
</head>
<body>
  <div id="drag-hint">Drag STL file here!</div>
  <!-- 기존: 모델 리스트 (가로 접기) -->
  <div id="model-list-container">
    <div id="model-list-header">
      <h3>Model List</h3>
      <button id="toggle-horizontal">&gt;</button>
    </div>
    <ul id="model-list"></ul>
  </div>

  <!-- 새 메모 입력 모달 -->
  <div id="memo-modal-new">
    <h2>새 메모 작성</h2>
    <textarea id="memo-input-new" rows="4" cols="30"></textarea>
    <br/><br/>
    <button id="memo-new-ok-btn">확인</button>
  </div>

  <!-- 기존 메모 수정 모달 -->
  <div id="memo-modal-edit">
    <h2>메모 수정</h2>
    <textarea id="memo-input-edit" rows="4" cols="30"></textarea>
    <br/><br/>
    <button id="memo-edit-update-btn">Update</button>
    <button id="memo-edit-delete-btn">Delete</button>
  </div>

  <!-- (새로 추가) Sculpt UI (왼쪽 하단) -->
  <div id="sculpt-ui">
    <h2>자유 수정</h2>
    <hr />
    <div class="brush-buttons">
      <button class="brush-btn" id="btn-normal">normal</button>
      <button class="brush-btn" id="btn-clay">clay</button>
      <button class="brush-btn" id="btn-flatten">flatten</button>
    </div>
    <div class="slider-row">
      <label for="intensityRange">Intensity (Ctrl + wheel) </label>
      <input type="range" id="intensityRange" min="1" max="100" step="1" value="50" />
    </div>
    <div class="slider-row">
      <label id="sizeLabel" for="sizeRange">Size (Shift + wheel)</label>
      <input type="range" id="sizeRange" min="0.025" max="0.25" step="0.005" value="0.1" />
    </div>
   
  </div>

  <!-- Vite import -->
  <script type="module" src="/src/main.js"></script>

  <script>
    // ▼ 모델 리스트 접기 버튼
    const container = document.getElementById('model-list-container');
    const toggleHorzBtn = document.getElementById('toggle-horizontal');
    toggleHorzBtn.addEventListener('click', e => {
      e.stopPropagation();
      container.classList.toggle('collapsed-horizontal');
    });

    // ▼ 브러시 UI (임시)
    const btnNormal   = document.getElementById('btn-normal');
    const btnClay     = document.getElementById('btn-clay');
    const btnFlatten  = document.getElementById('btn-flatten');

    let currentBrush = 'normal'; // default
    function setBrushMode(mode) {
      currentBrush = mode;
      btnNormal.classList.remove('active');
      btnClay.classList.remove('active');
      btnFlatten.classList.remove('active');
      if (mode === 'normal')  btnNormal.classList.add('active');
      if (mode === 'clay')    btnClay.classList.add('active');
      if (mode === 'flatten') btnFlatten.classList.add('active');
    }
    btnNormal.addEventListener('click',   ()=> setBrushMode('normal'));
    btnClay.addEventListener('click',     ()=> setBrushMode('clay'));
    btnFlatten.addEventListener('click',  ()=> setBrushMode('flatten'));
    setBrushMode('normal');

    // ▼ 슬라이더
    const sizeRange = document.getElementById('sizeRange');
    const intensityRange = document.getElementById('intensityRange');
    sizeRange.addEventListener('input', ()=> {
      // ...
    });
    intensityRange.addEventListener('input', ()=> {
      // ...
    });

    // ▼ OS 체크 → sizeLabel 문구 교체
    const isMac = navigator.userAgent.toLowerCase().includes('mac');
    const sizeLabel = document.getElementById('sizeLabel');
    if (sizeLabel) {
      if (isMac) {
        sizeLabel.textContent = 'Size (Command + wheel)';
      } else {
        sizeLabel.textContent = 'Size (Shift + wheel)';
      }
    }
  </script>
</body>
</html>
